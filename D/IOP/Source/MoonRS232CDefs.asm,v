head     1.1;
branch   1.1.1;
access   ;
symbols  start:1.1.1.1 Xerox:1.1.1;
locks    ; strict;
comment  @;; @;


1.1
date     2001.08.12.22.22.10;  author freier;  state Exp;
branches 1.1.1.1;
next     ;

1.1.1.1
date     2001.08.12.22.22.10;  author freier;  state Exp;
branches ;
next     ;


desc
@@



1.1
log
@Initial revision
@
text
@; Copyright (C) 1980, 1981  by Xerox Corporation. All rights reserved. ; ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~;-----------  Dandelion Processor Program - I/O Processor  -----------; ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~;  DESCRIPTION:      Definition File For RS232CTask.; ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~;  File: RS232CDefs.asm;  Stored:  [IRIS]<Workstation>IOP>SW>RS232CTask.dm;  Written by Ken KXY     .;  Modification History:;  - Created  by Ken KXY      : October 10, 1980  4:32 PM;  - Last modification by Dan dD     :  May 9, 1981  11:04 PM; ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~; FlagKind Added(January 22, 1981  19:09 PM); FillerCount change from 3 to 4 (January 23, 1981  12:08 PM); GetTaskStatus added (February 4, 1981  12:39 PM); Interruption added (February 20, 1981  3:46 PM); Make Tx and Rx Fifos 50 bytes (May 9, 1981  11:04 PM); Make Rx Fifo 100 bytes (May 14, 1981  5:46 PM); ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~; [i8253 Programmable Interval Timer (Read/Write)] ;- - - Control Word- - -OSCCMD	EQU	76H	; 01110110	; Counter#1, LSB &MSB, Mode3, BianryTimeCMD	EQU	0B0H	; 10110000	; Counter#2, LSB & MSB, Mode0 and Binary ; [i8257 Programmable DMA Controller (Read/Write)]; - - -  Command - - -EnableCh2  EQU	4H	; 00000100	; CH2(Rx) EnableEnableCh3  EQU	8H	; 00001000	; CH3(Tx) Enable; - - - Constants - - -DMARead   EQU	80H		; Address Modify bit for TC Data (Rd=Dev ¬ mem)DMAWrite   EQU	40H		; Address Modify bit for TC Data(Wr=Mem ¬ Dev)DMACountMask  EQU	3FH; [ Z80-SIO Constants ];  [ WR0]REG0	EQU	0	; 00000000	; Register Address 0REG1	EQU	1	; 00000001	; Register Address 1REG2	EQU	2	; 00000010	; Register Address 2REG3	EQU	3	; 00000011	; Register Address 3REG4	EQU	4	; 00000100	; Register Address 4REG5	EQU	5	; 00000101	; Register Address 5REG6	EQU	6	; 00000110	; Register Address 6REG7	EQU	7	; 00000111	; Register Address 7SIORegMask EQU	REG7SndABT	EQU	8H	; 00001000	; Send Abort Command (SDLC Only) RstEInt	EQU	10H	; 00010000	; Reset Ext/Status Int Command ChRst	EQU	18H	; 00011000	; Channel Reset Command IntRxCEn	EQU	20H	; 00100000	; Enable Int on Next Rx Character RstTxIP	EQU	28H	; 00101000	; Reset Tx Int PendingERRst	EQU	30H	; 00110000	; Error ResetRETI	EQU	38H	; 00111000	; Return from INT ( CH-A Only)RstRxCRC  EQU	40H	; 01000000	; Reset Rx CRC CheckerRstTxGEN  EQU	80H	; 10000000	; Reset Tx CRC GeneratorRstTxEOM  EQU	0C0H	; 11000000	; Reset Tx Underrun/EOM Latch; [ WR1]ExIntEn	EQU	1H	; 00000001	; External Interrupt Enable BitTxIntEn	EQU	2H	; 00000010	; Transmitter Interrupt EnableSAVect	EQU	4H	; 00000100	; Status Affects Vector(CH-B ONLY)RxIntFst	EQU	8H	; 00001000	; Rx Int On First CharacterIntACRxP	EQU	10H	; 00010000	; Int On All Characters (Parity  Affects Vector)IntACRx	EQU	18H	; 00011000	; Int On All Characters (Parity Doesn't Affects Vector)WROnRT	EQU	20H	; 00100000	; Wait/Ready on R/T(Tx=0)WRFunc	EQU	40H	; 01000000	; Wait/Ready Function(1:Ready Func,0:Wait Func)WREnbl	EQU	80H	; 10000000	; Wait/Ready EnableDmaRdy	EQU	WREnbl+WRFunc+WROnRTTxDmaRdy	EQU	WREnbl+WRFuncRxDmaRdy	EQU	WREnbl+WRFunc+WROnRT; [WR2] VECTOR REGISTER ( CH-B ONLY); [WR 3]RxEnbl	EQU	1H	; 00000001	; Receive EnableSyChInh	EQU	2H	; 00000010	; Sync Character Load InhibitAdrsSrch	EQU	4H	; 00000100	; Address Serch Mode (SDLC Only)RxCRCEn   EQU	8H	; 00001000	; Receiver CRC EnableHuntPh	EQU	10H	; 00010000	; Enter Hunt PhaseAutoEn	EQU	20H	; 00100000	; Auto EnablesRxBC5	EQU	0H	; 00000000	; Rx 5 Bits/CharacterRxBC6	EQU	80H	; 10000000	; Rx 6 Bits/CharacterRxBC7	EQU	40H	; 01000000	; Rx 7 Bits/CharacterRxBC8	EQU	0C0H	; 11000000 	; Rx 8 Bits/Character; [WR 4]ParOn	EQU	1H	; 00000001	; Parity ON/OFF ( 1=ON )ParEvn	EQU	2H	; 00000010	; Parity Even/Odd ( 1=Even )SModeEn	EQU	0H	; 00000000	; Sync Mode EnableStop1	EQU	4H	; 00000100	; 1 Stop Bit/CharacterStop1H	EQU	8H	; 00001000	; 1.5 Stop Bits/CharcterStop2	EQU	0CH	; 00001100	; 2 Stop Bits/CharcterSync8B	EQU	0H	; 00000000	; 8 Bit Sync CharcterSync16B	EQU	10H	; 00010000	; 16 Bit Sync CharcterSDLCM	EQU	20H	; 00100000	; SDLC Mode (01111110 FLAG)ExtSync	EQU	30H	; 00110000	; External Sync ModeClk1X	EQU	0H	; 00000000	; x1 Clock ModeClk16X	EQU	40H	; 01000000	; X16 Clock ModeClk32X	EQU	80H	; 10000000	; X32 Clock ModeClk64X	EQU	0C0H	; 11000000	; X64 Clock Mode; [WR5]TxCRCEn	EQU	1H	; 00000001	; Transmitter CRC EnableRTS	EQU	2H	; 00000010	; Request to SendCRC16	EQU	4H	; 00000100	; CRC16/SDLC' ( 1=CRC16 )TxEn	EQU	8H	; 00001000	; Transmitter EnableSBreak	EQU	10H	; 00010000	; Send BreakTxBC5	EQU	0H	; 00000000	; Tx 5 Bits/CharacterTXBC6	EQU	40H	; 01000000	; Tx 6 Bits/CharacterTxBC7	EQU	20H	; 00100000	; Tx 7 Bits/CharacterTxBC8	EQU	60H	; 01100000	; Tx 8 Bits/CharacterDTR	EQU	80H	; 10000000	; Data Terminal ready ; [WR6]; N/A; [WR7]SDLCFlag   EQU	7EH		; Opening/Closing Flag of SDLC mode; [RR0]RChAbl	EQU	1H	; 00000001 ; Receive Character AvairableIntPenA	EQU	2H	; 00000010	; Interrupt Pending  ( CH A Only )TBEmp	EQU	4H	; 00000100	; Transmitte Buffer EmptyDCD	EQU	8H	; 00001000	; Data Carry DetectSyncHunt	EQU	10H	; 00010000	; Sync/Hunt (SYNC=0)CTS	EQU	20H	; 00100000	; Clear To SendTxURun	EQU	40H	; 01000000	; Tx Underrun/EOMBkABT	EQU	80H	; 10000000	; Break/Abort; [RR1]  <Special Condition>ALLSent	EQU	1H		; All Sent bit (Async only)ParityErr	EQU	10H		; Parity ErrorRxORun	EQU	20H		; RxOver Run ErrorCRCErr	EQU	40H		; CRC ErrorEOF	EQU	80H		; End of  Frame; [RR2] Channel B ONLYTxInt	EQU	0H		; Ch B Transmit Buffer EmptyTxExtINT	EQU	2H		; Ch B External/Status ChangeVEC2	EQU	4H		; Ch B Receive Character AvailableTxSpeINT	EQU	6H		; Ch B Special Receive ConditionVEC4	EQU	8H		; Ch A Transmit Buffer EmptyRxExtINT	EQU	0AH		; Ch A External/Status ChangeRxInt	EQU	0CH		; Ch A Receive Character AvailableRxSpeINT	EQU	0EH		; Ch A Special Receive ConditionAffectMask EQU	0EH		; Mask for Status Affect Vector; [Command]On		EQU	0H	; On CommandOff		EQU	1H	; Off CommandSendBreak 	EQU	2H	; SendBreak CommandAbortInput  	EQU	3H	; AbortInput CommandAbortOutput	EQU	4H	; AbortOutput CommandAbortStatus	EQU	5H	; AbortStatus CommandSetStatus		EQU	6H	; SetStatus CommandStatusWait  	EQU	7H	; StatusWait CommandSetParameters	EQU	8H	; SetParameters CommandResetline		EQU	9H	; Resetline CommandPut		EQU	0AH	; Put CommandGet		EQU	0BH	; Get CommandTransmitNow	EQU	0CH	; TransmitNow CommandTransferStatus	EQU	0DH	; TransferStatus CommandMinorSetParameters	EQU	0EH	; SetParameters only RTS, DTR  etc.; [Other Constants]CommandMask 	EQU	0FH	; Command Separation MaskRS366StatusMask	EQU	3FH	; RS366Status Separation MaskRS366ResetMask	EQU	0C0H	; Reset Current Status MaskSuccess		EQU	80HUnInplemented	 EQU	1HTimeToSend	EQU	0FFH	; Device Status Count to sendFullFlag		EQU	80H	; Done Flag of CSBDoneMask		EQU	7FH	; Full Flag Reset MaskTxSeq		EQU	1H	; Tx Sequence IndicatorRxSeq		EQU	0H	; Rx Sequence IndicatorRxCondxError	EQU	1H	; Error Inidicator of Rx Condition Check S/RTxCondxError	EQU	2H	; Error Inidicator of Tx Condition Check S/RRxBufferMappingError  EQU	3H	; Error Indicator of RxBlockWrite S/RTxBufferMappingError  EQU	4H	; Error Indicator of TxBlockWrite S/RSequenceError	EQU	5H	; Error Indicator of Sequence Check S/R; [ Transfer Status ]XferSuccess	EQU	80H DataLost		EQU	1HDeviceError 	EQU	80HFrameTimeOutSt 	EQU	40HCheckSumError 	EQU	20HParityError    	EQU	10HAsyncFramingError 	EQU	8HInvalidCharacter 	EQU	4HAborted		EQU	2HDisaster		EQU	1H; [ RS232C Device Status ]DSDataLost	EQU	0HBreakDetected	EQU	80HClearToSend	EQU	20HDataSetReady	EQU	2HCarrierDetected	EQU	8HRingHeard	  	EQU	1HRingIndicator	EQU	1HDeviceStatusMask	EQU	DCD+CTS	; Device Status Separate Mask ( Sync/SDLC Mode)ASDeviceStatusMask	EQU	DCD+CTS+BkABT	; Device Status Separate Mask ( Async Mode); [ RS232C / SIO Parameter Convasion Table]; - CP Parameter Separation MaskCPRRHMask	EQU	80H	; Reset RingHeardMaskCPRBDMask	EQU	40H	; Reset BreakDetect MaskCPRDLMask   	EQU	20H	; Reset Data Lost MaskCPRTSMask	EQU	10HCPDTRMask	EQU	8HCPStopBitsMask	EQU	4HCPCharLMask 	EQU	18H	;CPSyncCntMask 	EQU	7H	;CPLineSpeedMask 	EQU	0FH	;; - Line Type (WR4)CPLineTypeMask	EQU	3H	;  Transfer Mode Command Separation MaskCPBitSyncMode	EQU	0H	;  SDLC ModeCPByteSyncMode	EQU	1H	;  Syncchronous ModeCPAsyncMode	EQU	2H	;  ASynchronous ModeCPAutoRecogMode	EQU	3H	;  Auto Recognition Mode (not Executed temporaly)SIOModeResetMask	EQu	3H	;  WR4SIOSDLCMode	EQU	Clk1X+SDLCM+SModeEnSIOSyncMode	EQU	Clk1X+Sync16B+SModeEnSIOAsyncMode	EQU	Clk16X+Sync8B; This Mode is Specified by additional Stop bit information.; - Parity (WR4)CPParityMask	EQU	0E0H	; Parity Command Separation MaskCPNonParity	EQU	0H	; No Parity SpecifiedCPOddParity	EQU	20H	; Odd Parity SpecifiedCPEvenParity	EQU	40H	; Even Parity SpecifiedCPOneParity	EQU	60H	; No Parity Specified, But Add "1"bitCPZeroParity	EQU	80H	; No Parity Specified, But Add "0"bitSIOParityClearMask	EQU	0FFH-ParOn-ParEvnSIONoParity	EQU	0HSIOEvenParity	EQU	ParOn+ParEvnSIOOddParity	EQU	ParOnSIODTR		EQU	DTRSIORTS		EQU	RTSOneParity		EQU	80HDTRClearMask	EQU	0FFH-SIODTRRTSClearMask	EQU	0FFH-SIORTSSIOTxCharClearMask	EQU	0FFH-TxBC8SIORxCharClearMask	EQU	0FFH-RxBC8; [ Constants in RxCondition] <Other constants = BkABT, SyncHunt >SIOEOF	EQU	TBEmpSIOCRCErr EQU	IntPenASIORxORun EQU	RChAblSIOParityErr EQU	TxURun; [ Constants in TxCondition] <Other constants = TxURun >SIONoDataToSend EQU IntPenA		; ###CHECK Bit Assignment				; ###CHECK Change of Contents of Condition(XOR); [Other Constants]SyncOSCMode	EQU	1HASyncOSCMode	EQU	0HRS366InvMask EQU	30H		; RS366 Signal software invert maskAbortInputStatus	EQU	1AbortOutputStatus	EQU	2FillerCount		EQU	3	; Number of Filler Character ModemSyncCount	EQU	2	; Number of ModemSync CharacterModemSync	EQU	0TRANSync		EQU	1NTRANSync	EQU	2FillerSync		EQU	3; [GetTaskStatus]		; !32RxEnabled  EQU	1H	; Rx have been EnabledIOCBRead   EQU	2H	; IOCB have Been ReadIOPInit	EQU	4H	; IOP Havs been initiatedGetReady	EQU	8H	; CP Get Flag has been set; [SDLCStateFlag]		; SDLCReady          EQU	0HSeqStarted   EQU	1HDMACompleted    EQU	2HCRCSending   EQU	3H; [ Buffers]TxBufferSize  EQU	600		; Size Of Tx Buffer(in Byte)SizeToSend   EQU	64		; Must be even number!!WordSizeToSend EQU	32		; SizeToSend/2RxBufferSize EQU	SizeToSendRxBlockA	EQU	0RxBlockB	EQU	1RxSDLCBufferSize 	EQU	600; [ FIFOs]FIFOoverflow   EQU	1HRxFIFOSize      EQU	100TxFIFOSize      EQU	50; [Correspondents]xerox800		EQU	0xerox850		EQU	1system6		EQU	2cmcll		EQU	3ttyHost		EQU	4oisSystemElement	EQU	5ibm3270Host	EQU	6ibm2270Host	EQU	7ibm6670Host	EQU	8ibm6670		EQU	9xerox860		EQU	10oisSystemElementBSC	EQU	11; [ Special Character Code]; - Xerox 850/860AsciiBELL	EQU	07BAsciiDLE	EQU	20BAsciiENQ	EQU	05BAsciiEOT	EQU	04BAsciiETB	EQU	27BAsciiETX	EQU	03BAsciiITB	EQU	37BAsciiNAK	EQU	25BAsciiSOH	EQU	01BAsciiSTX	EQU	02BAsciiSYN	EQU	26B; - IBM DevicesEbicdicBELL	EQU	77BEbicdicDLE	EQU	20BEbicdicENQ	EQU	55BEbicdicEOT	EQU	67BEbicdicETB	EQU	46BEbicdicETX	EQU	03BEbicdicITB		EQU	37BEbicdicNAK	EQU	75BEbicdicSOH	EQU	01BEbicdicSTX	EQU	02BEbicdicSYN	EQU	62BFiller		EQU	0FFHModemSYN 	EQU	55HAscii	EQU	0HEbicdic	EQU	1H; [Table Coversion Code]TableBELL	EQU	0HTableDLE	EQU	1HTableENQ	EQU	2HTableEOT	EQU	3HTableETB	EQU	4HTableETX	EQU	5HTableITB	EQU	6HTableNAK	EQU	7HTableSOH	EQU	8HTableSTX	EQU	9HTableSYN	EQU	0AHTableData	EQU	0BH; [ Sequence Condition ]START		EQU	0HNTRAN		EQU	10HITB1		EQU	20HITB2		EQU	30HITB3		EQU	40HSOH1		EQU	50HETX1		EQU	60HETX2		EQU	70HDLE1		EQU	80HDLE2		EQU	90HTRAN		EQU	0A0HTRAND		EQU	0B0HEndOfFrame	EQU	0C0HFillerSent		EQU	0D0HIrregalCharacter	EQU	0FEHTypicalData	EQU	40HTxStandBy		EQU	0FFHRxStandBy		EQU	0FFHTxEnabled		EQU	0HDummy		EQU	0HStateMask		EQU	0F0HRuleMask		EQU	0FHRule1		EQU	1HRule2		EQU	2HRuleRxC		EQU	4HRuleC		EQU	8H; Following Informations and Commands are effective in one Channel; Interrupt Pending : Channel A; Return From Interrupt Command : Channel A; Perimary Channel RTS : Channel B; Data Terminal ready : Channel B; Status Affect Vector : Channel B; Interrupt Vector : Chaanel BChAData	EQU	SIOBase		; SIO Channel A Data RegisterChBData	EQU	SIOBase+1	; SIO Channel B Data RegisterChACont	EQU	SIOBase+2	; SIO Channel A Control RegisterChBCont	EQU	SIOBase+3	; SIO Channel A Control RegisterTxCMD	EQU	76H	; 01110110	; Counter#1, LSB &MSB, Mode3, BianryRxCMD	EQU	0B6H	; 10110110	; Counter#2, LSB &MSB, Mode3, BianryTimCMD	EQU	0B0H	; 10110000	; Counter#2, LSB & MSB, Mode0 and BinaryTxReg	EQU	OSCBase+1	; Counter for SIO TxRxReg	EQU	OSCBase+2	; Counter for SIO Rx; [ RAM Area ]RAMBase	EQU	5100H		; Begining  Address of RAM occupied  				; by SIOTest.asm (Should be changed)CopyArea   EQU	RAMBase		; SIO Command Copy AreaVector	EQU	CopyArea+1	; Interrupt Vector Store AreaTESTFlag	EQU	CopyArea+2	; TEST Mode FlagBUFCNT	EQU	CopyArea+3	; Buffer Counterspace	EQU	CopyArea+4	; Tx Word Counterspace1	EQU	CopyArea+5	; Rx Word CounterPattern	EQU	CopyArea+6	; Transfer Pattern RegisterVRIABL	EQU	CopyArea+7	; TEST Valiation Reg (ASYNC Mode)BaudRate   EQU	CopyArea+8	; Baud Rate RegisterRPTCNT	EQU	CopyArea+9	; Test Repeat CounterWCNT	EQU	CopyArea+10	; Word Counter of SIOCopy routineConditionA EQU	CopyArea+11	; SIO Condition Flag for Channel AConditionB EQU	CopyArea+12	; SIO Condition Flag for Channel BNowStaA	EQU	CopyArea+13	; Current Channel-A  Status NowStaB	EQU	CopyArea+14	; Current Channel-B  StatusPreStaA	EQU	CopyArea+15	; Previous Channel-A StatusPreStaB	EQU	CopyArea+16	; Previous Channel-B StatusTBuffer	EQU	CopyArea+100H	RBuffer	EQU	TBuffer+100H	; [WR6]SYCH1	EQU	55H	; Sync Character 1/Check Address(SDLC)IntReg	EQU	0E9H		; Interrupt Request Register;- - - Status Bit - - - SIOInt	EQU	  4H		; SIO Int Request Mask; (Tx)CondADRS	EQU	1H		; ADRS has been sentCondTEND EQU	2H		; Specified Words SentCondETXT	EQU	4H		; ETX DetectedCondCRCT EQU	8H		; CRC SentCondALT	EQU	10H		; End of Transmitt ActionCondEOT	EQU	20H		; End Of Transmittion(Bi-Sync); (Rx)CondSync	EQU	1H		; Enterd into Sync ModeCondETXR EQU	2H		; Character ETX ReceivedCondCRCR EQU	4H		; CRC1 ReceivedCondCRCR2 EQU	8H		; CRC2 ReceivedCondCRCR3 EQU	10H		; Dummy ReceivedCondALR	EQU	20H		; All Character ReceivedCondEOF	EQU	40H		; EOF detectedETX	EQU	03B		; End of Text	END	RS232CDefs.asm@


1.1.1.1
log
@first add
@
text
@@
